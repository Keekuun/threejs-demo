<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>音频质量分析工具</title><link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script><style>@layer utilities{.content-auto{content-visibility:auto}.audio-wave{height:80px;display:flex;align-items:center;gap:2px;justify-content:center}.audio-wave span{width:3px;height:16px;background:linear-gradient(to bottom,#3b82f6,#2563eb);border-radius:3px;animation:wave 1s infinite ease-in-out}@keyframes wave{0%,100%{transform:scaleY(.3)}50%{transform:scaleY(1)}}.audio-wave span:nth-child(2){animation-delay:.1s}.audio-wave span:nth-child(3){animation-delay:.2s}.audio-wave span:nth-child(4){animation-delay:.3s}.audio-wave span:nth-child(5){animation-delay:.4s}.audio-wave span:nth-child(6){animation-delay:.5s}.audio-wave span:nth-child(7){animation-delay:.6s}.audio-wave span:nth-child(8){animation-delay:.7s}.audio-wave span:nth-child(9){animation-delay:.8s}.audio-wave span:nth-child(10){animation-delay:.9s}}</style><script type="module" crossorigin src="/threejs-demo/assets/__uno-BPY9SOXt.js"></script><link rel="stylesheet" crossorigin href="/threejs-demo/assets/__uno-CmaqJYAE.css"><link rel="stylesheet" crossorigin href="/threejs-demo/assets/tailwind-BKBndfPt.css"></head><body class="bg-gray-50 font-inter text-dark min-h-screen flex flex-col"><header class="bg-white shadow-sm sticky top-0 z-10"><div class="container mx-auto px-4 py-3 flex justify-between items-center"><div class="flex items-center space-x-2"><i class="fa fa-microphone text-primary text-2xl"></i><h1 class="text-xl font-bold text-dark">音频质量分析工具</h1></div><div class="flex items-center space-x-4"><button id="helpBtn" class="text-gray-600 hover:text-primary transition-colors duration-200 border px-1 rounded"><i class="fa fa-question-circle"></i> <span class="hidden md:inline ml-1">帮助</span></button></div></div></header><main class="flex-grow container mx-auto px-4 py-8"><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-1"><div class="bg-white rounded-xl shadow-md p-6 h-full flex flex-col"><h2 class="text-lg font-semibold mb-4 flex items-center"><i class="fa fa-circle text-primary mr-2"></i>录音控制</h2><div id="recorderContainer" class="flex-grow flex flex-col justify-center items-center"><div id="initialState" class="text-center"><div class="w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center mb-4 mx-auto"><i class="fa fa-microphone text-primary text-4xl"></i></div><p class="text-gray-600 mb-6">点击下方按钮开始录音</p><button id="startRecordBtn" class="bg-primary hover:bg-primary/90 text-white py-3 px-8 rounded-full transition-all duration-200 shadow-md hover:shadow-lg flex items-center"><i class="fa fa-circle mr-2"></i>开始录音</button></div><div id="recordingState" class="text-center !hidden"><div class="audio-wave mb-4"><span></span><span></span><span></span><span></span><span></span> <span></span><span></span><span></span><span></span><span></span></div><p class="text-gray-600 mb-6">录音中 <span id="recordingTime">00:00</span></p><div class="flex space-x-4 justify-center"><button id="pauseRecordBtn" class="bg-gray-200 hover:bg-gray-300 text-dark py-3 px-6 rounded-full transition-all duration-200 shadow-sm hover:shadow-md flex items-center"><i class="fa fa-pause mr-2"></i>暂停</button> <button id="stopRecordBtn" class="bg-danger hover:bg-danger/90 text-white py-3 px-6 rounded-full transition-all duration-200 shadow-md hover:shadow-lg flex items-center"><i class="fa fa-stop mr-2"></i>停止</button></div></div><div id="pausedState" class="text-center !hidden"><div class="w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mb-4 mx-auto"><i class="fa fa-pause text-gray-500 text-4xl"></i></div><p class="text-gray-600 mb-6">录音已暂停 <span id="pausedTime">00:00</span></p><div class="flex space-x-4 justify-center"><button id="resumeRecordBtn" class="bg-primary hover:bg-primary/90 text-white py-3 px-6 rounded-full transition-all duration-200 shadow-md hover:shadow-lg flex items-center"><i class="fa fa-microphone mr-2"></i>继续录音</button> <button id="resetRecordBtn" class="bg-gray-200 hover:bg-gray-300 text-dark py-3 px-6 rounded-full transition-all duration-200 shadow-sm hover:shadow-md flex items-center"><i class="fa fa-refresh mr-2"></i>重置</button></div></div><div id="completedState" class="text-center !hidden"><div class="w-24 h-24 bg-secondary/10 rounded-full flex items-center justify-center mb-4 mx-auto"><i class="fa fa-check text-secondary text-4xl"></i></div><p class="text-gray-600 mb-6">录音已完成，时长 <span id="completedTime">00:00</span></p><div class="flex space-x-4 justify-center"><button id="playRecordBtn" class="bg-primary hover:bg-primary/90 text-white py-3 px-6 rounded-full transition-all duration-200 shadow-md hover:shadow-lg flex items-center"><i class="fa fa-play mr-2"></i>播放</button> <button id="analyzeBtn" class="bg-accent hover:bg-accent/90 text-white py-3 px-6 rounded-full transition-all duration-200 shadow-md hover:shadow-lg flex items-center"><i class="fa fa-bar-chart mr-2"></i>分析音频</button></div><div class="mt-6"><audio id="recordedAudio" controls class="w-full"></audio></div></div></div></div></div><div class="lg:col-span-2"><div class="bg-white rounded-xl shadow-md p-6 h-full flex flex-col"><h2 class="text-lg font-semibold mb-4 flex items-center"><i class="fa fa-bar-chart text-accent mr-2"></i>音频质量分析</h2><div id="analysisPlaceholder" class="flex-grow flex flex-col justify-center items-center text-center py-12"><div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4"><i class="fa fa-file-audio-o text-gray-400 text-4xl"></i></div><p class="text-gray-500 mb-2">暂无分析数据</p><p class="text-gray-400 text-sm">录制音频并点击"分析音频"按钮开始分析</p></div><div id="analysisResults" class="!hidden flex-grow"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-gray-50 rounded-lg p-4"><h3 class="font-medium mb-3 flex items-center"><i class="fa fa-area-chart text-primary mr-2"></i>波形图</h3><div class="h-48"><canvas id="waveformChart"></canvas></div></div><div class="bg-gray-50 rounded-lg p-4"><h3 class="font-medium mb-3 flex items-center"><i class="fa fa-line-chart text-secondary mr-2"></i>频谱图</h3><div class="h-48"><canvas id="spectrumChart"></canvas></div></div><div class="bg-gray-50 rounded-lg p-4 md:col-span-2"><h3 class="font-medium mb-3 flex items-center"><i class="fa fa-tachometer text-accent mr-2"></i>质量指标</h3><div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"><div class="bg-white p-3 rounded shadow-sm"><p class="text-sm text-gray-500 mb-1">平均响度</p><div class="flex items-end justify-between"><p id="loudnessValue" class="text-xl font-semibold">-∞ dB</p><div class="w-16 h-2 bg-gray-200 rounded-full overflow-!hidden"><div id="loudnessBar" class="h-full bg-primary rounded-full" style="width:0%"></div></div></div></div><div class="bg-white p-3 rounded shadow-sm"><p class="text-sm text-gray-500 mb-1">清晰度</p><div class="flex items-end justify-between"><p id="clarityValue" class="text-xl font-semibold">--</p><div class="w-16 h-2 bg-gray-200 rounded-full overflow-!hidden"><div id="clarityBar" class="h-full bg-secondary rounded-full" style="width:0%"></div></div></div></div><div class="bg-white p-3 rounded shadow-sm"><p class="text-sm text-gray-500 mb-1">噪声水平</p><div class="flex items-end justify-between"><p id="noiseValue" class="text-xl font-semibold">--</p><div class="w-16 h-2 bg-gray-200 rounded-full overflow-!hidden"><div id="noiseBar" class="h-full bg-danger rounded-full" style="width:0%"></div></div></div></div><div class="bg-white p-3 rounded shadow-sm"><p class="text-sm text-gray-500 mb-1">整体评分</p><div class="flex items-end justify-between"><p id="overallScore" class="text-xl font-semibold">--</p><div class="flex text-yellow-400"><i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i></div></div></div></div></div><div class="bg-gray-50 rounded-lg p-4 md:col-span-2"><h3 class="font-medium mb-3 flex items-center"><i class="fa fa-signal text-primary mr-2"></i>频率响应</h3><div class="h-48"><canvas id="frequencyChart"></canvas></div></div><div class="bg-gray-50 rounded-lg p-4 md:col-span-2"><h3 class="font-medium mb-3 flex items-center"><i class="fa fa-lightbulb-o text-accent mr-2"></i>改进建议</h3><div id="analysisRecommendations" class="bg-white p-4 rounded-lg border border-gray-100 min-h-[100px]"><p class="text-gray-500 italic">完成音频分析后将显示改进建议...</p></div></div></div></div></div></div></div></main><div id="helpModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 !hidden"><div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="p-6 border-b"><div class="flex justify-between items-center"><h3 class="text-xl font-bold">使用帮助</h3><button id="closeHelpBtn" class="text-gray-400 hover:text-gray-600"><i class="fa fa-times"></i></button></div></div><div class="p-6"><div class="space-y-4"><div><h4 class="font-semibold mb-2">如何使用本工具</h4><ol class="list-decimal list-inside space-y-2 text-gray-700"><li>点击"开始录音"按钮开始录制音频</li><li>如需暂停录音，点击"暂停"按钮</li><li>完成录音后，点击"停止"按钮</li><li>可以点击"播放"按钮预览录制的音频</li><li>点击"分析音频"按钮获取音频质量分析结果</li></ol></div><div><h4 class="font-semibold mb-2">指标说明</h4><dl class="space-y-2 text-gray-700"><dt class="font-medium">平均响度</dt><dd>音频的平均音量水平，以分贝(dB)为单位</dd><dt class="font-medium">清晰度</dt><dd>语音清晰度评分，基于频率平衡和噪声水平</dd><dt class="font-medium">噪声水平</dt><dd>背景噪声的相对强度，低噪声表示更纯净的音频</dd><dt class="font-medium">整体评分</dt><dd>基于多个指标的综合评分(1-5星)</dd></dl></div><div><h4 class="font-semibold mb-2">录音建议</h4><ul class="list-disc list-inside space-y-2 text-gray-700"><li>使用质量较好的麦克风</li><li>保持麦克风与嘴部适当距离(约10-15厘米)</li><li>在安静的环境中录音，减少背景噪声</li><li>避免直接对着麦克风呼吸</li><li>说话时保持稳定的音量</li></ul></div></div></div><div class="p-6 border-t flex justify-end"><button id="closeHelpBtn2" class="bg-primary hover:bg-primary/90 text-white py-2 px-6 rounded-full transition-all duration-200 shadow-md hover:shadow-lg">确定</button></div></div></div><footer class="bg-dark text-white py-6"><div class="container mx-auto px-4"><div class="flex flex-col md:flex-row justify-between items-center"><div class="mb-4 md:mb-0"><p class="text-gray-400 text-sm">&copy; 2025 音频质量分析工具 | 保护你的听力健康</p></div><div class="flex space-x-4"><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200"><i class="fa fa-github"></i> </a><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200"><i class="fa fa-twitter"></i> </a><a href="#" class="text-gray-400 hover:text-white transition-colors duration-200"><i class="fa fa-linkedin"></i></a></div></div></div></footer><script>document.addEventListener("DOMContentLoaded",(function(){let e,t,n,a,d,s,o,i,c,l=[],r=!1,u=!1,m=0;const h=document.getElementById("startRecordBtn"),y=document.getElementById("pauseRecordBtn"),g=document.getElementById("stopRecordBtn"),p=document.getElementById("resumeRecordBtn"),f=document.getElementById("resetRecordBtn"),B=document.getElementById("playRecordBtn"),L=document.getElementById("analyzeBtn"),x=document.getElementById("recordedAudio"),E=document.getElementById("recordingTime"),I=document.getElementById("pausedTime"),v=document.getElementById("completedTime"),w=document.getElementById("initialState"),M=document.getElementById("recordingState"),b=document.getElementById("pausedState"),C=document.getElementById("completedState"),k=document.getElementById("analysisPlaceholder"),A=document.getElementById("analysisResults"),R=document.getElementById("helpBtn"),S=document.getElementById("helpModal"),z=document.getElementById("closeHelpBtn"),q=document.getElementById("closeHelpBtn2"),H=document.getElementById("loudnessValue"),D=document.getElementById("clarityValue"),F=document.getElementById("noiseValue"),T=document.getElementById("overallScore"),U=document.getElementById("loudnessBar"),W=document.getElementById("clarityBar"),$=document.getElementById("noiseBar"),V=document.getElementById("analysisRecommendations");let j,O,P;function G(e){const t=Math.floor(m/60),n=m%60;e.textContent=`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}R.addEventListener("click",(()=>{S.classList.remove("!hidden")})),[z,q].forEach((e=>{e.addEventListener("click",(()=>{S.classList.add("!hidden")}))})),S.addEventListener("click",(e=>{e.target===S&&S.classList.add("!hidden")})),h.addEventListener("click",(function(){navigator.mediaDevices.getUserMedia({audio:!0}).then((h=>{a||(a=new(window.AudioContext||window.webkitAudioContext)),d=a.createAnalyser(),d.fftSize=2048,o=d.frequencyBinCount,s=new Uint8Array(o),i=a.createMediaStreamSource(h),i.connect(d),e=new MediaRecorder(h),e.ondataavailable=e=>{e.data.size>0&&l.push(e.data)},e.onstop=()=>{t=new Blob(l,{type:"audio/wav"}),n=URL.createObjectURL(t),x.src=n,h.getTracks().forEach((e=>e.stop())),clearInterval(updateWaveInterval)},e.start(),r=!0,u=!1,w.classList.add("!hidden"),M.classList.remove("!hidden"),b.classList.add("!hidden"),C.classList.add("!hidden"),c=setInterval((()=>{m++,G(E)}),1e3);const y=document.querySelectorAll(".audio-wave span");updateWaveInterval=setInterval((()=>{d.getByteFrequencyData(s);s.reduce(((e,t)=>e+t),0);const e=80/255;y.forEach(((t,n)=>{const a=s[n%o],d=Math.min(80,a*e);t.style.height=`${d}px`}))}),50)})).catch((e=>{console.error("录音权限被拒绝:",e),alert("请允许麦克风访问权限以使用录音功能")}))})),y.addEventListener("click",(function(){e&&r&&!u&&(e.pause(),u=!0,M.classList.add("!hidden"),b.classList.remove("!hidden"),clearInterval(c),G(I))})),g.addEventListener("click",(function(){e&&(r||u)&&(e.stop(),r=!1,u=!1,M.classList.add("!hidden"),b.classList.add("!hidden"),C.classList.remove("!hidden"),clearInterval(c),G(v))})),p.addEventListener("click",(function(){e&&r&&u&&(e.resume(),u=!1,M.classList.remove("!hidden"),b.classList.add("!hidden"),c=setInterval((()=>{m++,G(E)}),1e3))})),f.addEventListener("click",(function(){e&&(r||u)&&(e.stop(),r=!1,u=!1);l=[],t=null,n=null,m=0,clearInterval(c),w.classList.remove("!hidden"),M.classList.add("!hidden"),b.classList.add("!hidden"),C.classList.add("!hidden"),k.classList.remove("!hidden"),A.classList.add("!hidden"),a&&a.close().then((()=>{a=null}))})),B.addEventListener("click",(function(){n&&x.play()})),L.addEventListener("click",(function(){if(!t)return;k.classList.add("!hidden"),A.classList.remove("!hidden"),a||(a=new(window.AudioContext||window.webkitAudioContext));const e=new FileReader;e.onload=function(e){a.decodeAudioData(e.target.result).then((e=>{!function(e){const t=e.getChannelData(0),n=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n]*e[n];return Math.sqrt(t/e.length)}(t),a=20*Math.log10(n),d=function(e){const t=1024,n=Math.floor(e.length/t),a=[];for(let d=0;d<n;d++){let n=0;for(let a=0;a<t;a++)n+=e[d*t+a]*e[d*t+a];a.push(Math.sqrt(n/t))}a.sort(((e,t)=>e-t));const d=Math.floor(.2*a.length),s=(a[d],a.slice(0,d).reduce(((e,t)=>e+t),0)),o=a.reduce(((e,t)=>e+t),0);return Math.min(100,Math.max(0,Math.round(s/o*100)))}(t),s=function(e){const t=1024,n=(new Array(t).fill(0),Math.floor(t/4));let a=0,d=0;for(let s=0;s<e.length;s+=10){Math.min(t-1,Math.floor(Math.abs(e[s])*t))<n?a+=e[s]*e[s]:d+=e[s]*e[s]}const s=a+d,o=s>0?Math.round(d/s*100):0;return Math.min(100,Math.max(0,o))}(t),o=function(e,t,n){const a=Math.min(100,Math.max(0,(e+60)/60*100)),d=t,s=100-n,o=Math.round(.3*a+.4*d+.3*s),i=Math.max(1,Math.min(5,Math.round(o/20)));return{score:o,stars:i}}(a,s,d);(function(e,t,n,a){H.textContent=e.toFixed(1)+" dB";const d=Math.min(100,Math.max(0,(e+60)/60*100));U.style.width=d+"%",D.textContent=t+"%",W.style.width=t+"%",F.textContent=n+"%",$.style.width=n+"%",T.textContent="★".repeat(a.stars)+"☆".repeat(5-a.stars),e>-20?H.classList.add("text-danger"):e>-30?H.classList.add("text-accent"):H.classList.add("text-secondary");t>80?D.classList.add("text-secondary"):t>60?D.classList.add("text-accent"):D.classList.add("text-danger");n<20?F.classList.add("text-secondary"):n<40?F.classList.add("text-accent"):F.classList.add("text-danger")})(a,s,d,o),function(e){const t=document.getElementById("waveformChart").getContext("2d");j&&j.destroy();const n=Math.max(1,Math.floor(e.length/1e3)),a=[];for(let t=0;t<e.length;t+=n)a.push(e[t]);j=new Chart(t,{type:"line",data:{labels:a.map(((e,t)=>t)),datasets:[{label:"波形",data:a,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:1,pointRadius:0,fill:!0,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!1},y:{display:!0,min:-1,max:1,ticks:{stepSize:.5}}},plugins:{legend:{display:!1}}}})}(t),function(e){const t=document.getElementById("spectrumChart").getContext("2d");O&&O.destroy();const n=new(window.AudioContext||window.webkitAudioContext),a=n.createBufferSource();a.buffer=e;const d=n.createAnalyser();d.fftSize=2048;const s=d.frequencyBinCount,o=new Uint8Array(s);a.connect(d),a.start(),d.getByteFrequencyData(o);const i=[],c=[],l=Math.floor(s/50);for(let e=0;e<s;e+=l){const t=Math.round(e*n.sampleRate/d.fftSize);i.push(t),c.push(o[e])}O=new Chart(t,{type:"bar",data:{labels:i,datasets:[{label:"频谱",data:c,backgroundColor:"rgba(16, 185, 129, 0.7)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"频率 (Hz)"},ticks:{callback:function(e){const t=i[e];return t<1e3?t+"Hz":t/1e3+"kHz"},maxTicksLimit:10}},y:{title:{display:!0,text:"强度"}}},plugins:{legend:{display:!1}}}}),a.onended=()=>{n.close()}}(e),function(e){const t=document.getElementById("frequencyChart").getContext("2d");P&&P.destroy();const n=new(window.AudioContext||window.webkitAudioContext),a=n.createBufferSource();a.buffer=e;const d=n.createAnalyser();d.fftSize=2048;const s=d.frequencyBinCount,o=new Uint8Array(s);a.connect(d),a.start(),d.getByteFrequencyData(o);const i=[],c=[],l=[],r=Math.floor(s/50);for(let e=0;e<s;e+=r){const t=Math.round(e*n.sampleRate/d.fftSize);i.push(t),c.push(o[e]),l.push(128)}P=new Chart(t,{type:"line",data:{labels:i,datasets:[{label:"实际响应",data:c,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,pointRadius:0,fill:!1,tension:.2},{label:"理想响应",data:l,borderColor:"#9CA3AF",borderWidth:1,borderDash:[5,5],pointRadius:0,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"频率 (Hz)"},ticks:{callback:function(e){const t=i[e];return t<1e3?t+"Hz":t/1e3+"kHz"},maxTicksLimit:10}},y:{title:{display:!0,text:"强度"},min:0,max:255}}}}),a.onended=()=>{n.close()}}(e),function(e,t,n){const a=[];e<-40?a.push("• 录音音量过低，建议提高麦克风增益或靠近麦克风"):e>-15&&a.push("• 录音音量过高，可能导致失真，建议降低麦克风增益或远离麦克风");t<60&&(a.push("• 语音清晰度较低，可能是由于发音不清晰或频率不平衡导致的"),a.push("• 建议在发音时更加清晰，并确保麦克风能够捕捉到完整的频率范围"));n>30&&(a.push("• 背景噪声较高，建议在更安静的环境中录音"),a.push("• 考虑使用带有噪声抑制功能的麦克风或软件"));0===a.length?V.innerHTML='<p class="text-green-600">音频质量良好，无需改进！</p>':V.innerHTML=`<ul class="list-disc list-inside space-y-2 text-gray-700">${a.join("")}</ul>`}(a,s,d)}(e)})).catch((e=>{console.error("解码音频失败:",e),alert("分析音频失败，请重试")}))},e.readAsArrayBuffer(t)}))}))</script></body></html>