<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>元素连接线演示</title><style>@layer utilities{.content-auto{content-visibility:auto}.element-shadow{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.canvas-container{position:relative;overflow:hidden}.bezier-handle{cursor:move;transition:all .2s ease}.bezier-handle:hover{transform:scale(1.2)}}</style><script type="module" crossorigin src="/threejs-demo/assets/modulepreload-polyfill-B5Qt9EMX.js"></script><link rel="stylesheet" crossorigin href="/threejs-demo/assets/tailwind-BKBndfPt.css"><link rel="stylesheet" crossorigin href="/threejs-demo/assets/__uno-E6sQOvll.css"></head><body class="bg-gray-50 min-h-screen font-sans"><div class="container mx-auto px-4 py-8 max-w-5xl"><header class="mb-8 text-center"><h1 class="text-[clamp(1.75rem,4vw,2.5rem)] font-bold text-gray-800 mb-2">元素连接线演示</h1><p class="text-gray-600 max-w-2xl mx-auto">此示例展示了如何在元素之间绘制连接线，包括基础连接线、贝塞尔曲线连接线和可交互的贝塞尔曲线演示。</p></header><div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><i class="fa fa-link text-primary mr-2"></i> 固定元素连接线</h2><div class="canvas-container w-full h-[300px] border-2 border-gray-200 rounded-lg relative" id="fixedElementsContainer"><canvas id="fixedConnectionCanvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-10"></canvas><div class="fixed-element absolute w-16 h-16 bg-primary rounded-lg flex items-center justify-center text-white element-shadow" data-id="fixed1" style="top:60px;left:80px;z-index:20"><i class="fa fa-circle text-xl"></i></div><div class="fixed-element absolute w-16 h-16 bg-secondary rounded-lg flex items-center justify-center text-white element-shadow" data-id="fixed2" style="top:180px;left:300px;z-index:20"><i class="fa fa-square text-xl"></i></div></div></div><div><h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><i class="fa fa-arrows text-primary mr-2"></i> 可拖拽元素连接线</h2><div class="canvas-container w-full h-[300px] border-2 border-gray-200 rounded-lg relative" id="canvasContainer"><canvas id="connectionCanvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-10"></canvas><div class="draggable-element absolute w-16 h-16 bg-primary rounded-lg flex items-center justify-center text-white cursor-move element-shadow" data-id="element1" style="top:60px;left:80px;z-index:20"><i class="fa fa-code text-xl"></i></div><div class="draggable-element absolute w-16 h-16 bg-secondary rounded-lg flex items-center justify-center text-white cursor-move element-shadow" data-id="element2" style="top:180px;left:300px;z-index:20"><i class="fa fa-database text-xl"></i></div></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8"><h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><i class="fa fa-curve text-primary mr-2"></i> 贝塞尔曲线演示</h2><div class="canvas-container w-full h-[300px] border-2 border-gray-200 rounded-lg relative" id="bezierDemoContainer"><canvas id="bezierCanvas" class="absolute top-0 left-0 w-full h-full z-10"></canvas><div class="bezier-handle absolute w-6 h-6 bg-accent rounded-full flex items-center justify-center text-white element-shadow cursor-move" data-type="start" style="top:80px;left:100px;z-index:20"></div><div class="bezier-handle absolute w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white element-shadow cursor-move" data-type="control1" style="top:50px;left:220px;z-index:20"></div><div class="bezier-handle absolute w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white element-shadow cursor-move" data-type="control2" style="top:180px;left:280px;z-index:20"></div><div class="bezier-handle absolute w-6 h-6 bg-accent rounded-full flex items-center justify-center text-white element-shadow cursor-move" data-type="end" style="top:150px;left:400px;z-index:20"></div></div><div class="mt-4 text-sm text-gray-600"><p class="flex items-center"><i class="fa fa-info-circle text-primary mr-2"></i> <span>拖动红色控制点调整曲线形状，拖动蓝色端点改变曲线位置</span></p></div></div><div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-8"><h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center"><i class="fa fa-info-circle text-primary mr-2"></i> 功能说明</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="bg-gray-50 p-4 rounded-lg"><h3 class="font-semibold text-gray-800 mb-2">固定元素连接线</h3><ul class="text-gray-600 space-y-1 text-sm"><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>展示两个固定位置元素之间的连接线</span></li><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>基于贝塞尔曲线算法，自动计算控制点</span></li></ul></div><div class="bg-gray-50 p-4 rounded-lg"><h3 class="font-semibold text-gray-800 mb-2">可拖拽元素连接线</h3><ul class="text-gray-600 space-y-1 text-sm"><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>元素可以自由拖拽，连接线实时更新</span></li><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>使用贝塞尔曲线，确保连接线平滑自然</span></li></ul></div><div class="bg-gray-50 p-4 rounded-lg"><h3 class="font-semibold text-gray-800 mb-2">贝塞尔曲线演示</h3><ul class="text-gray-600 space-y-1 text-sm"><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>直观展示贝塞尔曲线的工作原理</span></li><li class="flex items-start"><i class="fa fa-check text-green-500 mt-1 mr-2"></i> <span>通过控制点调整曲线形状和张力</span></li></ul></div></div></div></div><script>function initFixedElementConnection(){const e=document.getElementById("fixedConnectionCanvas"),t=e.getContext("2d"),n=document.getElementById("fixedElementsContainer"),o=[{from:"fixed1",to:"fixed2",color:"#3B82F6",thickness:2}];function i(){e.width=n.clientWidth,e.height=n.clientHeight,c()}function c(){t.clearRect(0,0,e.width,e.height),o.forEach((e=>{const o=document.querySelector(`[data-id="${e.from}"]`),i=document.querySelector(`[data-id="${e.to}"]`);o&&i&&function(e,o,i,c){const l=e.getBoundingClientRect(),d=o.getBoundingClientRect(),r=n.getBoundingClientRect(),s=l.left+l.width/2-r.left,a=l.top+l.height/2-r.top,m=d.left+d.width/2-r.left,u=d.top+d.height/2-r.top;t.strokeStyle=i,t.lineWidth=c,t.beginPath(),t.moveTo(s,a),t.lineTo(m,u),t.stroke()}(o,i,e.color,e.thickness)}))}i(),window.addEventListener("resize",i),c()}function initDraggableElementConnection(){const e=document.getElementById("connectionCanvas"),t=e.getContext("2d"),n=document.getElementById("canvasContainer"),o=[{from:"element1",to:"element2",color:"#3B82F6",thickness:2}];function i(){e.width=n.clientWidth,e.height=n.clientHeight,c()}function c(){t.clearRect(0,0,e.width,e.height),o.forEach((e=>{const o=document.querySelector(`[data-id="${e.from}"]`),i=document.querySelector(`[data-id="${e.to}"]`);o&&i&&function(e,o,i,c){const l=e.getBoundingClientRect(),d=o.getBoundingClientRect(),r=n.getBoundingClientRect(),s=l.left+l.width/2-r.left,a=l.top+l.height/2-r.top,m=d.left+d.width/2-r.left,u=d.top+d.height/2-r.top;t.strokeStyle=i,t.lineWidth=c,t.beginPath(),t.moveTo(s,a),t.lineTo(m,u),t.stroke()}(o,i,e.color,e.thickness)}))}i(),window.addEventListener("resize",i);const l=document.querySelectorAll(".draggable-element");let d,r,s=!1,a=null;function m(e){if(!s)return;const t=n.getBoundingClientRect();let o=e.clientX-t.left-d,i=e.clientY-t.top-r;o=Math.max(0,Math.min(n.clientWidth-a.offsetWidth,o)),i=Math.max(0,Math.min(n.clientHeight-a.offsetHeight,i)),a.style.left=`${o}px`,a.style.top=`${i}px`,c()}function u(){s=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",u)}l.forEach((e=>{e.addEventListener("mousedown",(function(e){s=!0,a=this;const t=this.getBoundingClientRect();n.getBoundingClientRect();d=e.clientX-t.left,r=e.clientY-t.top,document.addEventListener("mousemove",m),document.addEventListener("mouseup",u)}))})),c()}function initBezierDemo(){const e=document.getElementById("bezierCanvas"),t=e.getContext("2d"),n=document.getElementById("bezierDemoContainer"),o={start:{x:100,y:80,element:document.querySelector('[data-type="start"]')},control1:{x:220,y:50,element:document.querySelector('[data-type="control1"]')},control2:{x:280,y:180,element:document.querySelector('[data-type="control2"]')},end:{x:400,y:150,element:document.querySelector('[data-type="end"]')}};function i(){e.width=n.clientWidth,e.height=n.clientHeight,c()}function c(){t.clearRect(0,0,e.width,e.height),t.beginPath(),t.moveTo(o.start.x,o.start.y),t.lineTo(o.control1.x,o.control1.y),t.moveTo(o.control2.x,o.control2.y),t.lineTo(o.end.x,o.end.y),t.strokeStyle="#94A3B8",t.lineWidth=1,t.setLineDash([5,5]),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(o.start.x,o.start.y),t.bezierCurveTo(o.control1.x,o.control1.y,o.control2.x,o.control2.y,o.end.x,o.end.y),t.strokeStyle="#3B82F6",t.lineWidth=3,t.stroke(),l(o.start.x,o.start.y,"#3B82F6"),l(o.control1.x,o.control1.y,"#EF4444"),l(o.control2.x,o.control2.y,"#EF4444"),l(o.end.x,o.end.y,"#3B82F6")}function l(e,n,o){t.beginPath(),t.arc(e,n,6,0,2*Math.PI),t.fillStyle=o,t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=1,t.stroke()}i(),window.addEventListener("resize",i);let d=!1,r=null;function s(e){if(!d)return;const t=n.getBoundingClientRect();let i=e.clientX-t.left,l=e.clientY-t.top;i=Math.max(10,Math.min(n.clientWidth-10,i)),l=Math.max(10,Math.min(n.clientHeight-10,l)),function(e,t,n){const i=o[e];i&&(i.x=t,i.y=n,i.element.style.left=t-3+"px",i.element.style.top=n-3+"px",c())}(r,i,l),e.preventDefault()}function a(){d&&(d=!1,o[r].element.style.zIndex=20,o[r].element.classList.remove("scale-110"),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a))}Object.keys(o).forEach((e=>{o[e].element.addEventListener("mousedown",(function(t){t.preventDefault(),d=!0,r=e,this.style.zIndex=30,this.classList.add("scale-110"),document.addEventListener("mousemove",s),document.addEventListener("mouseup",a)}))})),setTimeout(c,100)}document.addEventListener("DOMContentLoaded",(function(){initFixedElementConnection(),initDraggableElementConnection(),initBezierDemo()}))</script></body></html>